                                 dispkeyfunc3.mac
      ファンクションキー・バーのようなものを表示＆押下したキーの機能を図示するマクロ
                             秀丸 Ver.8 (以上) 専用版

          狭い画面に、シンプルなインターフェース。
          表示行は多めがよくって、操作はもっぱらキーボード。
          だけどショートカットキーは忘れがち。
          そんなあなたとあなたの環境に。

　これは、dispkeyfunc3.macのreadmeファイル<README.txt>です。

1. 概要説明
1-1. dispkeyfunc3.macってなに？
 　秀丸エディッタ用のマクロです。
 　"ファンクションキー・バー" もどきを表示します。
 　キーを押すと、それに割り当てられている機能を図示します。

1-2. だれとく？
 　秀丸を主にキーボードで操作されており、画面が狭いなどの理由で1行でも表示行を増やしたい環境で使われることを想定しています。
 　そのような環境で、ショートカットキーを確認したい(ファンクションキーはもちろんそれ以外のキーに割り当てられている機能を確かめたい）ことがあり、普段は非表示だけど確認するときだけそれなりのもの表示してくれればいい、とお考えの場合にお役に立てると思います。
 　なお、自称初心者の方の使用はお勧めしていません。

1-3. で、具体的な機能は？
 　起動すると、アウトプット枠を表示し、そこにファンクションキー・バーのようなものを図示します。
 　ファンクションキー・バーとは異なり、複数列(種類)表示できます。
 　初期設定では、[F1〜F12]および[Ctrl+F1〜F12]に割り当てられた機能を表示します。

1-3-1. "ファンクションキー・バー"って何さ？
 　秀丸で「ファンクションキー表示」したときに画面下部に表示されるあれです。
 　秀丸ではこうは言わないのですが、こういう呼称を使うソフトウェアは多いですし、説明がややこしいのであえてこの用語を使います。

1-3-2. それ以外の機能は？
 　[Ctrl]、[Shift]、[Alt](以下、「修飾キー」)を押下すると、ファンクションキー・バーのように、押したキーにあわせて、割り当てられている機能を表示します。
 　たとえば[Ctrl]を押すと、[Ctrl+F1〜F12]に割り当てられた機能を図示します。

1-3-3. ファンクションキー以外も表示できる？
 　「修飾キー」以外のキーを押すと、押したキーやそれに関連したキーの機能を図示します。
 　たとえば[A]を押すと、[Ctrl+A]や[Ctrl+Shift+A]など全ての修飾キーの組み合わせを図示します。

1-3-4. 機能が割り当たっていない場合の表示はどうなるの？
 　たとえば[Shift+@]の機能として「`を入力」と表示したり、機能が割り当てされていない/できない場合にはその旨を表示することもできます。

1-3-5. 秀丸の「ファンクションキー表示」みたいに、機能名が長くても端折ってくれるの？
 　いろいろと工夫します。

1-3-6. 機能名の表示フォーマットをいじれたりできるの？
 　テンプレートファイルをいじれば、ある程度の変更はできます。
 　テンプレートファイルは、配布ファイルに2つ同梱しています。

1-4. 機能名を表示するだけ？
 　修飾キー以外のキーを押し続けて数秒(初期設定では2秒）経過すると、割り当てられている機能を実行し終了します。
 　たとえば、[Ctrl+A]を押し続けていると、「すべてを選択」されます。
 　何も押していない、または修飾キーのみを押し続けている場合は、数秒(初期設定では5秒）後に自動でマクロを終了します。

1-5. できそうでできない機能は何？
 　アウトプット枠の設定をほとんど考慮していません。
 　具体的には、アウトプット枠に6行以上表示でき、枠の位置は上か下に設定されていることを想定しており、1行の文字数も全然考慮していません。これをマクロがよしなに変更して表示することもありません。
 　マウスクリックに割り当てられている機能名の表示はできません。システム全体で使われているショートカットキーを押下した場合は、そちらの実行が優先されるため、動作は不定です。
 　そのほかにもあるかもしれません。

1-5-1. 任意の機能名に割り当てられた、すべてのキーを一覧することはできませんか。
 　このバージョンではできません。しかし、次のバージョンではがんばってみます。

1-6. 雑多なこと
1-6-1. 名前の由来は？
 　そのまんま、DISplay KEY FUNCtionからです。
 　末尾に 3 という数字がついているのは、フルスクラッチから3回書き直した証左です。

1-6-2. どこで手に入れることができるの？どこから手に入れたっけ？
 　後述する<2. 配布場所>をご覧ください。

1-6-3. 誰が作っているの？誰に連絡したらいいの？
 　後述する<6. コンタクト、サポート>をご覧ください。
 　なお、作者の知識の粋を尽くして作っているため、それ以上の事態になったら、サポートが十分にできない可能性があります。また、そのため、自称初心者の方の使用はお勧めしていません。

1-6-4. 私の環境でも使えますか？
 　後述する<4. 必要なもの>をご覧ください。<7. 謝辞、免責、ライセンス>もお読みください。

1-6-5. インストールやアンインストール、バージョンアップの方法は？
 　後述する<5. インストールとバージョンアップ、アンインストール>をご覧ください。

1-6-6. 使い方や設定方法は？
 　配布ファイルに同梱されている<dispkeyfunc3.mac.txt>をご覧ください。

1-6-7. 改版履歴をみたいです。
 　どうしてもみたいのなら、配布ファイルに同梱されている<dispkeyfunc3.mac.history.txt>をご覧ください。
 　詳細な改版履歴を確認したい場合は、後述する<2. 配布場所>に記載のgithubサイトでgitレポジトリも公開しています。


2. 配布場所

 　以下のURLからダウンロードできます。
http://hide.maruo.co.jp/lib/macro/dispkeyfunc.html
 　見つからない場合は、以下のURLから「dispkeyfunc」などで検索してみてください。
http://hide.maruo.co.jp/lib/macro/index.html

 　また、以下のURLからもダウンロードできます。「download」ボタンをクリックして、"ZIP"を選択してください。
http://github.com/taketori/dispkeyfunc/downloads
 　gitのリポジトリも公開しています。


3. 配布ファイルに同梱されているもの

 dispkeyfunc3.mac :             以下、「マクロ本体」
 README.txt :                  「README」。このファイルです。
 dispkeyfunc3.mac.txt :        「マニュアル」。使い方や設定方法を記載しています。
 dispkeyfunc3.mac.js :         「本マクロ用JScript」。キーコードを発行するJScript。
 dispkeyfunc3.mac.template :   「標準テンプレート」
 dispkeyfunc3.mac.templateB :  「おまけテンプレート」
 hmkey.rsc :                   「キーリソース」。キーコードを文字に変換するための資料。
 commonkey.list :              「共通ショートカットキーリスト」
 dispkeyfunc3.mac.history.txt :「改版履歴」

 　「共通ショートカットキーリスト」は、秀丸の一般的な動作についてのみ記載しています。http://www.microsoft.com/japan/enable/products/keyboard/default.mspx などを参考に、適宜追記してください。


4. 必要なもの

 　以下のような環境が必要です。他にもあるかもしれませんが、一般的なユーザなら多分大丈夫でしょう。
 　KEY.TXTについては、秀丸エディッタのヘルプを参照してください。

 ・秀丸エディッタ Ver 8以上が動作する。
 ・COM・秀丸エディッタ同梱のDLLなどの呼び出し・実行できる権限がある。
 ・マクロ本体が存在するフォルダ及びそこに存在するファイルに対して、読み取り・実行・書き込みなどができる権限がある。
   　設定によっては、dispkeyfunc3.mac.dat、dispkeyfunc3.mac.prev.key、dispkeyfunc3.mac.now.keyの各ファイルを作る場合があります。

 ・KEY.TXTが、秀丸エディッタの実行ファイルと同じフォルダにあり、マクロ(というか秀丸エディッタ）から読み書きできる権限がある。← これがないorできないと、全く機能しません。

 　アウトプット枠は、以下のような状況であることを想定した作りになっています。
 ・表示行数が、6行以上。
 ・1行の文字数が、(半角換算で) 100文字前後。120文字程度あれば、F12まで表示できます。
 ・フォントは、等幅フォント。
 　アウトプット枠が想定の行数or文字数を表示できない場合、すべてを閲覧するためにスクロールする必要があります。また、プロポーショナルフォントでは図が見にくくなります。


5. インストールとバージョンアップ、アンインストール

 ・他の秀丸エディッタ用のマクロと同様です。
 　配布ファイルに含まれる全てのファイルを、同じフォルダに展開してください。
 ・KEY.TXTは、必ず作ってください。
 ・使い方、設定方法は、同梱のマニュアル<dispkeyfunc3.mac.txt>をご覧ください。

 ・バージョンアップ時の注意
 　ユーザ設定は、マクロ自体に書き込みます。従って、マクロをインストールするたびに設定し直す必要があります。

 ・アンインストール時のお知らせ
 　レジストリには書き込んでいません。また、マクロと同じフォルダ以外にはファイルを作りません。


6. コンタクト、サポート

6-1. 不具合報告及び要望などでの連絡先

 　メールや掲示板でお問い合わせの際は、本マクロについてであることがわかるように、題名にマクロ名を併記してください。

 ・メール
   src＠x10d.jp (@を半角に変更してから送信してください。)

 ・掲示板: コミュニテックス「4. 公開マクロ サポート会議室（秀丸エディタ関連）」
   http://www.maruo.co.jp/turukame/4/index.html

 ・githubのレポジトリ
   http://github.com/taketori/dispkeyfunc/
   Issuesもどうぞ。

6-2. それ以外の内容で作者に連絡を取りたい場合は、以下の方法で。

 ・メール
   taketori＠x10d.jp (@を半角に変更してから送信してください。)


7. 謝辞、免責、ライセンス

 　特に以下の皆様に感謝申し上げます。
 ・秀丸及びその関連DLL、及び幾多の便利なマクロを作成し公開されている作者の皆様。
 ・Windowsや秀丸のマクロ、WSHについて調査し、情報をまとめ、公開されている皆様。
 ・このマクロをお使いいただき、フィードバックしていただいた皆様。

 　作者の知識の粋を尽くして作っているため、それ以上の事態になったら、サポートが十分にできない可能性があります。また、そのため、自称初心者の方の使用はお勧めしていません。
 　このマクロに関する一切の不都合について、作者はその責を負いません。
 　詳細は、事項を参照してください。

7-1. 免責、ライセンス条項

 著作権は、私 "たけとり"、"taketori"、及び "x10d.jp" が2009年から保有しています。
 ライセンスは、いわゆる「修正BSD」です。

 Copyright (c) 2009, たけとり
 All rights reserved.
 ソースコード形式かバイナリ形式か、変更するかしないかを問わず、以下の条件を満たす場合に限り、再頒布および使用が許可されます。

 ソースコードを再頒布する場合、上記の著作権表示、本条件一覧、および下記免責条項を含めること。
 バイナリ形式で再頒布する場合、頒布物に付属のドキュメント等の資料に、上記の著作権表示、本条件一覧、および下記免責条項を含めること。
 書面による特別の許可なしに、本ソフトウェアから派生した製品の宣伝または販売促進に、たけとり及びtaketori、並びにx10d、x10d.jp、及びエクステンド、エクステンド・ジャパンの名前またはコントリビューターの名前を使用してはならない。
 本ソフトウェアは、著作権者およびコントリビューターによって「現状のまま」提供されており、明示黙示を問わず、商業的な使用可能性、および特定の目的に対する適合性に関する暗黙の保証も含め、またそれに限定されない、いかなる保証もありません。著作権者もコントリビューターも、事由のいかんを問わず、 損害発生の原因いかんを問わず、かつ責任の根拠が契約であるか厳格責任であるか（過失その他の）不法行為であるかを問わず、仮にそのような損害が発生する可能性を知らされていたとしても、本ソフトウェアの使用によって発生した（代替品または代用サービスの調達、使用の喪失、データの喪失、利益の喪失、業務の中断も含め、またそれに限定されない）直接損害、間接損害、偶発的な損害、特別損害、懲罰的損害、または結果損害について、一切責任を負わないものとします。

EOF